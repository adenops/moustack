<html>
<head>
<script type="text/javascript" src="jquery-2.2.0.min.js"></script>

<script src='swagger-client.js' type='text/javascript'></script>

<link rel="stylesheet" type="text/css" href="datatables-jqueryui/datatables.min.css"/>
<script type="text/javascript" src="datatables-jqueryui/datatables.js"></script>

<script type="text/javascript">
window.client = new SwaggerClient({
	url: window.location.protocol + "//" + window.location.host + "/rest/swagger.json",
	success: function() {
		createDatatable();
	}
});

function createDatatable() {
	table = $('#agents').DataTable( {
		"ajax": function (data, callback, settings) {
			client.agent.getAgents({responseContentType: 'application/json'}, function(datajson) {
				$('#debug').html(datajson.data);
				callback(datajson.obj);
			});
		},
		"sAjaxDataProp": "",
		"aaSorting" : [[1, "desc"]],
		"processing": true,
		"columns": [
            { "data": "hostname" },
            { "data": "lastReportId" },
            { "data": "connected" },
        ]
	});
	setInterval( function () {
        table.ajax.reload(null, false);
    }, 1000 );
}

</script>
</head>

<body>
  <h1>Agents</h1>
  <table id="agents" class="display" width="100%" cellspacing="0">
        <thead>
            <tr>
                <th>Hostname</th>
                <th>Last Report ID</th>
                <th>Connected</th>
            </tr>
        </thead>
  </table>
  <h3>Debug</h3>
  <div id="debug"></div>
</body>
</html>