#!/bin/sh

if [ -z "${LXC_NAME}" -o -z "${LXC_ROOTFS_MOUNT}" ]; then
	echo "This hook must be ran by lxc-start"
	exit 1
fi

# flush existing data directory if any
rm -rf ${LXC_ROOTFS_MOUNT}/openstack
mkdir -p ${LXC_ROOTFS_MOUNT}/openstack

# create ramdisk
mkdir -p /dev/shm/${LXC_NAME}/openstack

# bind ramdisk with docker data directory
mount -n --bind /dev/shm/${LXC_NAME}/openstack ${LXC_ROOTFS_MOUNT}/openstack
